---
import Button from "../../components/Button";
import Card, { Rarity } from "../../components/Card";
import BasePage from "../../layouts/BasePage.astro";
import { getInventory } from "../../util/serverRequests.js";

if (!Astro.cookies.has("authorization")) {
	return Astro.redirect("/login");
}

const cards = await getInventory(
	Astro.cookies.get("authorization")?.json().accessToken,
);

if (!cards) {
	return Astro.redirect("/login");
}
---

<BasePage>
	<Button href="/">Return to monke</Button>
	<h1 class="font-black text-4xl mb-4 drop-shadow-lg">Inventaire</h1>
	<div class="flex flex-wrap w-full gap-2">
		{
			cards.map((card: { name: string; image: string; rarity: number }) => (
				<Card
					client:visible
					name={card.name}
					artwork={card.image}
					rarity={card.rarity}
				/>
			))
		}
	</div>
</BasePage>
